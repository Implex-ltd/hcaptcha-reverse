package main

import (
	"fmt"
	"strings"
)

func main() {
	jwt := "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJmIjowLCJzIjoxNiwidCI6InciLCJkIjoiWjNRWGE5RkFoZUx1Q3VoaUFJM0oxMlVzWkFjRXZhVjlDaXc0dHlhbzVwL3NCVnVKTWs2KzBBaWZVbjhKUjVoMlQ5WlErU3VjVEdnS2RLcGFFdytkdk56cmRqczgwNFlidmNiQjhOOGFkV0xoL1lpZktxS1ZQb2phRi85and2NEpua3p2NEJvMENrV01rcElhS1FwYUdZYmdKckxUV3V1OFZJdmVMSmoyVVlINXhiSFBFZW1qbjZId0tLTHRNLzRoU0tUYTRNUkJvdzlmR1VVRUtCelRvTnV6ODFQaGxiWlo3VmdSZVUwSjF5Yy90VkxjUEE9PWNQNlVicktBQitIRmRWUDAiLCJsIjoiaHR0cHM6Ly9uZXdhc3NldHMuaGNhcHRjaGEuY29tL2MvMjgyZDBmZiIsImkiOiJzaGEyNTYtNlNtVlFhT0RmKy9hcCtXV3lDWW02eWJWZDBKenNUb2xrTXRLY1lSWWdQVT0iLCJlIjoxNzEyNTUyMzI4LCJuIjoiaHN3IiwiYyI6MTAwMH0.1uRoU1htMWn_cTHrD93tSMnvHSneOuy6X1PzWq6XUTc"
	        
	token, err := ParseJWT(jwt)
	if err != nil {
		panic(err)
	}

	fmt.Println(token.Difficuly, token.PowData)
	stamp, err := GetStamp(uint(token.Difficuly), token.PowData)
	if err != nil {
		panic(err)
	}

	fmt.Println("xx")

	// put your json string and put same %v/%s at the same place there is where data gonna be replaced
	fp := fmt.Sprintf(`{"proof_spec":{"difficulty":%v,"fingerprint_type":0,"_type":"w","data":"%v","_location":"https://newassets.hcaptcha.com/c/282d0ff","timeout_value":1000},"rand":[0.960537614638231,_rand],"components":{"navigator":{"user_agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36","language":"fr-FR","languages":["fr-FR","fr","en-US","en"],"platform":"Win32","max_touch_points":0,"webdriver":false,"notification_query_permission":null,"plugins_undefined":false},"screen":{"color_depth":24,"pixel_depth":24,"width":3440,"height":1440,"avail_width":3440,"avail_height":1392},"device_pixel_ratio":1,"has_session_storage":true,"has_local_storage":true,"has_indexed_db":true,"web_gl_hash":"-1","canvas_hash":"9373501784251927131","has_touch":false,"notification_api_permission":"Denied","chrome":true,"to_string_length":33,"err_firefox":null,"r_bot_score":0,"r_bot_score_suspicious_keys":[],"r_bot_score_2":0,"audio_hash":"-1","extensions":[false],"parent_win_hash":"9751511312137185722","webrtc_hash":"-1","performance_hash":"4140103483592612201","unique_keys":"1,unisat,hcaptcha,onSuccess,grecaptcha,0,onExpire","inv_unique_keys":"__wdata,_sharedLibs,image_label_binary,hsw,image_label_area_select","common_keys_hash":2614578394,"common_keys_tail":"stop,structuredClone,webkitCancelAnimationFrame,webkitRequestAnimationFrame,chrome,fence,caches,cookieStore,ondevicemotion,ondeviceorientation,ondeviceorientationabsolute,launchQueue,sharedStorage,documentPictureInPicture,getScreenDetails,queryLocalFonts,showDirectoryPicker,showOpenFilePicker,showSaveFilePicker,originAgentCluster,onpagereveal,credentialless,speechSynthesis,onscrollend,webkitRequestFileSystem,webkitResolveLocalFileSystemURL,providers,_phantomHideProvidersArray,_phantomShowMetamaskExplainer,isPhantomInstalled,regeneratorRuntime,SENTRY_RELEASE,web3,Raven,XverseProviders,btc_providers","features":{"performance_entries":true,"web_audio":true,"web_rtc":true,"canvas_2d":true,"fetch":true}},"events":[[2455893439,"\"Europe/Paris\""],[1438349120,"13177607191192652685"],[3227950072,"[24,24,65536,212988,200704]"],[3025237892,"12027682292028963860"],[4165641576,"[32767,32767,16384,8,8,8]"],[91877612,"[[[\"chrome-extension://idnnbdplmphpflfnlkomgpfbpcgelopg/inpage.js\",0,3],[\"https://newassets.hcaptcha.com/captcha/v1/17b82e2/hcaptcha.js\",0,5]],[[\"*\",84,9]]]"],[2252840959,"11079656286779448742"],[3487278513,"1135"],[2005859105,"[2147483647,2147483647,4294967294]"],[4272905495,"31.25000000745058"],[188652528,"[16,4095,30,16,16380,120,12,120,[23,127,127]]"],[2062697704,"[[277114314453,277114314460,277114314451,357114314456,277114314452,554228628898,57114314443,717114314371391,554228628897,277114314456,1108457257862,277114314450,554228628919,277114314460,277114314451],false]"],[1325100515,"true"],[1268522788,"[16384,32,16384,2048,2,2048]"],[1108939890,"[\"Europe/Paris\",-60,-60,-3203647761000,\"heure normale dâ€™Europe centrale\",\"fr\"]"],[1579262840,"[-6.172840118408203,-20.710678100585938,120.71067810058594,-20.710678100585938,141.42135620117188,120.71067810058594,-20.710678100585938,141.42135620117188,-20.710678100585938,-20.710678100585938,0,0,320,490,true]"],[2158825350,"[1,1024,1,1,4]"],[2509526170,"[2147483647,2147483647,2147483647,2147483647]"],[28433086,"16.400000005960464"],[2284058841,"40224"],[522949833,"[\"QzM1IjN5gzMYCDMX\",\"c\",\"1\",\"XAWOPPOCYTLBS\"]"],[2150450975,"16132118391739044799"],[2228825458,"1712155469384.5"],[639595872,"1444582"],[3197530747,"[3440,1440,3440,1392,24,24,false,0,1,2353,1399,true,true,true,false]"],[930901639,"41.70000000298023"],[3095117296,"[\"5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36\",\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36\",8,16,\"fr-FR\",[\"fr-FR\",\"fr\",\"en-US\",\"en\"],\"Win32\",null,[\"Google Chrome 123\",\"Not:A-Brand 8\",\"Chromium 123\"],false,\"Windows\",2,5,true,false,0,false,false,true,\"[object Keyboard]\",false,false]"],[2545605315,"[[\"LwitJG5mBmTGZo0uvinesalCMYuCsTJm\",\"19\",\"13\",\"TUEENBUIKYSVN\"],[\"VQoLKtgnKmLajmLY0umfLS=K0mJftmPajmLuHeFVZXwmKmLajmLEgeFVZXwajmLKKb3PgA5ntSxEDmyuCkwmgmwaDmyQDo5KCmyuSWUBjmLmDm2aDmyuyVznEmyuCtqTEd3hMAwItJtfKtJ5KRwItJOm\",\"5\",\"82\",\"KLMGOTNTZAUFP\"]]"],[3467501445,"57"],[262879291,"8398791803026140725"],[3570513324,"4631229088072584217"],[3235903591,"[[true,\"fr-FR\",true,\"Microsoft Hortense - French (France)\",\"Microsoft Hortense - French (France)\"],[false,\"fr-FR\",true,\"Microsoft Julie - French (France)\",\"Microsoft Julie - French (France)\"],[false,\"fr-FR\",true,\"Microsoft Paul - French (France)\",\"Microsoft Paul - French (France)\"]]"],[1019203231,"[[\"loadTimes\",\"csi\",\"app\"],35,34,null,false,false,true,37,true,true,true,true,true,[\"providers\",\"_phantomHideProvidersArray\",\"_phantomShowMetamaskExplainer\",\"isPhantomInstalled\",\"regeneratorRuntime\",\"SENTRY_RELEASE\",\"web3\",\"Raven\",\"_sharedLibs\",\"XverseProviders\",\"btc_providers\",\"hsw\",\"__wdata\",\"image_label_area_select\",\"image_label_binary\",\"ethereum\",\"phantom\",\"solana\",\"rabby\",\"rabbyWalletRouter\",\"StacksProvider\",\"BitcoinProvider\"],[[\"getElementsByClassName\",[]],[\"getElementById\",[]],[\"querySelector\",[]],[\"querySelectorAll\",[]]],[],true]"],[2840639612,"[1,4,5,7,9,12,20,21,24,25,29,31]"],[1538111826,"17157476241021694346"],[4250147733,"15307345790125003576"],[2963547975,"[16,1024,4096,7,12,120,[23,127,127]]"],[1007274290,"9345374751420407194"],[2772590518,"[\"Google Inc. (NVIDIA)\",\"ANGLE (NVIDIA, NVIDIA GeForce RTX 3060 Ti (0x00002489) Direct3D11 vs_5_0 ps_5_0, D3D11)\"]"],[104149656,"[0,1,2,3,4]"],[4173238370,"[[\"img:imgs3.hcaptcha.com\",0,25.55000000447035],[\"navigation:newassets.hcaptcha.com\",19.80000001192093,33.29999999701977],[\"script:newassets.hcaptcha.com\",16.25000000745058,29.899999998509884],[\"xmlhttprequest:api.hcaptcha.com\",0,204.59999999403954]]"],[1177832592,"[143526983270,143526983270,null,null,4294705152,true,true,true,null]"],[2163086961,"412.09999999403954"],[2416260428,"4932383211497360507"],[2444509564,"[\"Windows\",\"15.0.0\",null,\"64\",\"x86\",\"123.0.6312.86\"]"],[611315898,"8915205951503093450"],[850956849,"2944899007327630659"],[728511561,"4807243413252001311"],[1668959119,"631"],[1246555942,"[17]"],[3197521464,"18207788058829391080"],[1826871708,"[[221,[221,221,221,255,221,221,221,255,221,221,221,255,221,221,221,255]],[[11,0,0,95.96875,15,4,96.765625],[[12,0,-1,113.125,17,4,113],[11,0,0,111,12,4,111],[11,0,0,95.96875,15,4,96.765625],[11,0,0,95.96875,15,4,96.765625],[11,0,0,95.96875,15,4,96.765625],[11,0,0,95.96875,15,4,96.765625],[11,0,0,95.96875,15,4,96.765625],[11,0,0,95.96875,15,4,96.765625],[12,0,0,109.640625,14,3,110.1953125]]],[0,2,8,13,15,17,24,26,27,28,29,30,31,32,34,37,39,40,49,69,75,76,79,80],[0,0,0,0,14,3,0]]"],[2970644973,"[\"va6FXY=00Y6DHetZkmlG\",\"8\",\"e\",\"ORGCVWSNOSDMJ\"]"],[2620085432,"[4,120,4]"],[2974784595,"[0,10465,10465]"]],"suspicious_events":[],"messages":null,"stack_data":["Array.reduce (<anonymous>)\nonMessage (chrome-extension://gppongmhjkpfnbhagpmjfkannfbllamg/js/dom.js)","new Promise (<anonymous>)"],"stamp":"%v","href":"https://accounts.hcaptcha.com/demo","ardata":null,"errs":{"list":[]},"perf":[[1,6],[2,416]]}`, token.Difficuly, token.PowData, stamp)
	_, rand_int := RandHash([]byte(strings.ReplaceAll(fp, ",_rand", "")))
	fp_rand := strings.ReplaceAll(fp, "_rand", fmt.Sprintf("%v", rand_int))

	fmt.Println(fp_rand)
}
